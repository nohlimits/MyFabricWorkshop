{"name":"bronze-01-ingest-dimension_customer","ppdf:dataflowId":"709aa098-f7dd-4e1b-9427-544204b01b94","ppdf:owner":{"tenantId":"e8cb30c1-a6c6-4778-ab79-dc9f6c62a59d","userId":"0a11365d-2d43-4b6d-adee-3e33a73498e4"},"ppdf:fastCopy":false,"version":"1.0","culture":"en-US","modifiedTime":"2024-02-20T14:35:54.8727935+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":false,"queriesMetadata":{"DefaultDestination":{"queryId":"de6c9d82-442a-4da1-9599-7f796c2e5a33","queryName":"DefaultDestination"},"load_dimension_customer":{"queryId":"05f65058-e77b-473d-bf05-0f43e6dc790e","queryName":"load_dimension_customer","loadEnabled":true},"load_dimension_customer_DataDestination":{"queryId":"a54e41bd-94c2-4c8a-a5bd-97ef508e7310","queryName":"load_dimension_customer_DataDestination"},"load_dimension_customer_WriteToDataDestination":{"queryId":"c27e117e-d063-4161-a237-a534873ccd1c","queryName":"load_dimension_customer_WriteToDataDestination"},"load_dimension_customer_TransformForWriteToDataDestination":{"queryId":"1d9bf18d-5d62-43e4-9478-2a71052a8fcf","queryName":"load_dimension_customer_TransformForWriteToDataDestination"}},"document":"section Section1;\r\nshared DefaultDestination = let\r\n  DefaultDestination = Lakehouse.Contents(null){[workspaceId = \"4a01221c-57e7-4a14-a63b-c696f1c5d5aa\"]}[Data]{[lakehouseId = \"72e22d45-db1d-4cbb-be9f-3f8b7e1b20eb\"]}[Data]\r\nin\r\n  DefaultDestination;\r\n[Staging = \"DefaultStaging\"]\r\nshared load_dimension_customer = let\r\n  Source = Lakehouse.Contents(null){[workspaceId = \"4a01221c-57e7-4a14-a63b-c696f1c5d5aa\"]}[Data]{[lakehouseId = \"72e22d45-db1d-4cbb-be9f-3f8b7e1b20eb\"]}[Data],\r\n  #\"Navigation 1\" = Source{[Id = \"Files\", ItemKind = \"Folder\"]}[Data],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[Name = \"landing\"]}[Content],\r\n  #\"Navigation 3\" = #\"Navigation 2\"{[Name = \"wwi\"]}[Content],\r\n  Navigation = #\"Navigation 3\"{[Name = \"dimension_customer.csv\"]}[Content],\r\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 11, Encoding = 65001, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Promoted headers\", {{\"CustomerKey\", Int64.Type}, {\"WWICustomerID\", Int64.Type}, {\"Customer\", type text}, {\"BillToCustomer\", type text}, {\"Category\", type text}, {\"BuyingGroup\", type text}, {\"PrimaryContact\", type text}, {\"PostalCode\", type text}, {\"ValidFrom\", type datetime}, {\"ValidTo\", type datetime}, {\"LineageKey\", Int64.Type}})\r\nin\r\n  #\"Changed column type\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared load_dimension_customer_DataDestination = let\r\n  Pattern = Lakehouse.Contents([]),\r\n  Navigation_1 = Pattern{[workspaceId = \"4a01221c-57e7-4a14-a63b-c696f1c5d5aa\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"72e22d45-db1d-4cbb-be9f-3f8b7e1b20eb\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"dimension_customer\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[CustomerKey = nullable Int64.Type, WWICustomerID = nullable Int64.Type, Customer = nullable text, BillToCustomer = nullable text, Category = nullable text, BuyingGroup = nullable text, PrimaryContact = nullable text, PostalCode = nullable text, ValidFrom = nullable datetime, ValidTo = nullable datetime, LineageKey = nullable Int64.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"DefaultStaging\"]\r\nshared load_dimension_customer_WriteToDataDestination = let\r\n  load_dimension_customer_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = load_dimension_customer_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], load_dimension_customer_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  load_dimension_customer_WriteToDataDestination;\r\nshared load_dimension_customer_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(load_dimension_customer, {\"CustomerKey\", \"WWICustomerID\", \"Customer\", \"BillToCustomer\", \"Category\", \"BuyingGroup\", \"PrimaryContact\", \"PostalCode\", \"ValidFrom\", \"ValidTo\", \"LineageKey\"})\r\nin\r\n    SourceTable;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"load_dimension_customer","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"load_dimension_customer.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"CustomerKey","dataType":"int64"},{"name":"WWICustomerID","dataType":"int64"},{"name":"Customer","dataType":"string"},{"name":"BillToCustomer","dataType":"string"},{"name":"Category","dataType":"string"},{"name":"BuyingGroup","dataType":"string"},{"name":"PrimaryContact","dataType":"string"},{"name":"PostalCode","dataType":"string"},{"name":"ValidFrom","dataType":"dateTime"},{"name":"ValidTo","dataType":"dateTime"},{"name":"LineageKey","dataType":"int64"}]}]}